#  SQL for Library Management: DML and Advanced Queries

![Language](https://img.shields.io/badge/SQL-DML_&_DQL-purple.svg) 
![Tasks](https://img.shields.io/badge/Tasks_Solved-12-brightgreen.svg)

### Overview

This repository contains a SQL script demonstrating a series of data manipulation (DML), data query (DQL), and data definition (DDL) tasks performed on a **Library Management System** database. The tasks range from basic CRUD (Create, Read, Update, Delete) operations to more advanced queries involving joins, aggregations, and table creation from select statements (CTAS). This project showcases the ability to manage and extract meaningful insights from a relational database.

---

### Tasks Completed

1.  **Create** a new book record using `INSERT`.
2.  **Update** an existing member's address using `UPDATE`.
3.  **Delete** a record from the issued status table using `DELETE`.
4.  **Retrieve** all books issued by a specific employee.
5.  **List** members who have issued more than one book using `GROUP BY` and `HAVING`.
6.  **Create a summary table** of book issuance counts using `CREATE TABLE AS SELECT` (CTAS).
7.  **Retrieve** all books in a specific category.
8.  **Find** the total rental income generated by each book category.
9.  **List** members who registered within the last 180 days.
10. **List** employees with their respective branch details and manager's name using a `JOIN`.
11. **Create a new table** containing only books with a rental price above a certain threshold.
12. **Retrieve** a list of all books that have been issued but not yet returned.

---

### Detailed Analysis & Solutions

Here is a breakdown of each task, the SQL solution, and an explanation of the methodology.

#### 1. üìù Create a New Book Record
* **Objective:** Add a new record for 'To Kill a Mockingbird' into the `books` table.
* **Solution:**
    ```sql
    INSERT INTO BOOKS(isbn, book_title, category, rental_price, status, author, publisher)
    VALUES('978-1-60129-456-2', 'To Kill a Mockingbird', 'Classic', 6.00, 'yes', 'Harper Lee', 'J.B. Lippincott & Co.');
    ```
* **Explanation:** This query uses the `INSERT INTO` statement to add a new row to the `books` table. It specifies the columns to be populated and provides the corresponding values in the `VALUES` clause.

#### 2. üîÑ Update an Existing Member's Address
* **Objective:** Change the address for the member with `member_id` 'C101'.
* **Solution:**
    ```sql
    UPDATE members
    SET member_address = '3321 Side St'
    WHERE member_id = 'C101';
    ```
* **Explanation:** The `UPDATE` statement modifies existing records. The `SET` clause specifies which column to change and its new value, while the `WHERE` clause is crucial for targeting the exact record to update.

#### 3. üóëÔ∏è Delete a Record
* **Objective:** Delete a specific record from the `issued_status` table.
* **Solution:**
    ```sql
    DELETE FROM issued_status WHERE issued_id = 'IS121';
    ```
* **Explanation:** The `DELETE FROM` statement removes rows from a table. The `WHERE` clause identifies the specific row(s) to be deleted based on a condition.

#### 4. üîç Retrieve Books Issued by an Employee
* **Objective:** Select all books issued by the employee with `emp_id` 'E106'.
* **Solution:**
    ```sql
    SELECT * FROM issued_status WHERE issued_emp_id = 'E106';
    ```
* **Explanation:** A standard `SELECT` query that uses a `WHERE` clause to filter the `issued_status` table and retrieve only the records associated with a specific employee ID.

#### 5. üìà List Members with Multiple Book Issuances
* **Objective:** Find members who have checked out more than one book.
* **Solution:**
    ```sql
    SELECT issued_member_id, COUNT(issued_member_id) as books_issued
    FROM issued_status
    GROUP BY issued_member_id
    HAVING COUNT(issued_member_id) > 1;
    ```
* **Explanation:** This query first groups all records by `issued_member_id` and counts the number of issuances for each member. The `HAVING` clause then filters these groups, returning only those members whose issuance count is greater than one.
* **Note:** The original query was modified slightly to also show the `member_id` for better context.

#### 6. üèóÔ∏è Create a Summary Table with CTAS
* **Objective:** Create a new table (`book_issued_cnt`) that summarizes how many times each book has been issued.
* **Solution:**
    ```sql
    CREATE TABLE book_issued_cnt AS
    SELECT b.isbn, b.book_title, COUNT(ist.issued_id) AS issued_count
    FROM issued_status AS ist 
    JOIN books AS b ON ist.issued_book_isbn = b.isbn 
    GROUP BY b.isbn, b.book_title;
    ```
* **Explanation:** This query demonstrates the powerful `CREATE TABLE AS SELECT` (CTAS) statement. It first performs a `JOIN` between `issued_status` and `books`, aggregates the data to count issues per book, and then stores this summarized result in a completely new table.

#### 7. üìñ Retrieve Books by Category
* **Objective:** Get all books from the 'Literary Fiction' category.
* **Solution:**
    ```sql
    SELECT * FROM books WHERE category = 'Literary Fiction';
    ```
* **Explanation:** A simple `SELECT` statement that filters the `books` table based on the `category` column to retrieve a specific subset of data.

#### 8. üí∞ Find Total Rental Income by Category
* **Objective:** Calculate the sum of rental prices for all books, grouped by category.
* **Solution:**
    ```sql
    SELECT category, SUM(rental_price) AS total_rental_income
    FROM books
    GROUP BY category;
    ```
* **Explanation:** This query uses the `SUM()` aggregate function to calculate the total rental price. The `GROUP BY` clause ensures that the sum is calculated separately for each book `category`.

#### 9. üìÖ List Recently Registered Members
* **Objective:** Find all members who registered in the last 180 days.
* **Solution:**
    ```sql
    SELECT * FROM members WHERE reg_date >= CURRENT_DATE - INTERVAL '180 days';
    ```
* **Explanation:** This query filters the `members` table using a date-based condition. It leverages `CURRENT_DATE` and `INTERVAL` to dynamically calculate the date 180 days ago and find all members who registered on or after that date.

#### 10. üßë‚Äçüíº List Employees with Manager and Branch Details
* **Objective:** Retrieve a list of employees that includes their branch details and the name of their branch manager.
* **Solution:**
    ```sql
    SELECT 
        e1.emp_id,
        e1.emp_name,
        e1.position,
        b.branch_address,
        b.contact_no,
        e2.emp_name AS manager_name
    FROM employees AS e1
    JOIN branch AS b ON e1.branch_id = b.branch_id    
    JOIN employees AS e2 ON e2.emp_id = b.manager_id;
    ```
* **Explanation:** This query demonstrates a powerful `JOIN` technique. It joins `employees` (`e1`) with `branch` to get branch details. Then, it joins `branch` back to the `employees` table a second time (`e2`) using the `manager_id` to fetch the manager's name, which is a form of self-join via a bridge table.

#### 11. üè∑Ô∏è Create a Table of Expensive Books
* **Objective:** Create a new table that contains only books with a rental price greater than $4.00.
* **Solution:**
    ```sql
    CREATE TABLE expensive_books AS
    SELECT * FROM books WHERE rental_price > 4.00;
    ```
* **Explanation:** Another example of CTAS, this query first filters the `books` table to find all books meeting a price condition and then creates a new table, `expensive_books`, containing only those results.

#### 12. ‚è≥ Retrieve Books Not Yet Returned
* **Objective:** Get a list of all books that are currently checked out and have not been returned.
* **Solution:**
    ```sql
    SELECT ist.*
    FROM issued_status AS ist
    LEFT JOIN return_status AS rs ON rs.issued_id = ist.issued_id
    WHERE rs.return_id IS NULL;
    ```
* **Explanation:** This query uses a `LEFT JOIN` to connect `issued_status` with `return_status`. For issued books that have not been returned, there will be no matching record in `return_status`, making the columns from `rs` `NULL`. The `WHERE rs.return_id IS NULL` clause filters for precisely these records.